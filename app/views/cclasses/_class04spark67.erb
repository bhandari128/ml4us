<code class='bash'>
dan@pavlap:~/sparkapps/linr10 $ 
dan@pavlap:~/sparkapps/linr10 $ 
dan@pavlap:~/sparkapps/linr10 $ spark-shell -i linr11.scala 
Spark context Web UI available at http://192.168.1.80:4041
Spark context available as 'sc' (master = local[*], app id = local-1475094076009).
Spark session available as 'spark'.
Loading linr11.scala...
import org.apache.spark.sql.SQLContext
import org.apache.spark.ml.regression.LinearRegression
import org.apache.spark.ml.linalg.{Vector, Vectors}
import org.apache.spark.ml.param.ParamMap
import org.apache.spark.sql.Row
import org.apache.spark.sql.functions._
training_period: String = " WHERE Date BETWEEN'1986-01-01'AND'2016-01-01' "
test_period: String = " WHERE Date BETWEEN'2016-01-01'AND'2017-01-01' "
import sys.process._
warning: there was one feature warning; re-run with -feature for details
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100 1181k    0 1181k    0     0  2456k      0 --:--:-- --:--:-- --:--:-- 2457k
res2: Int = 0
warning: there was one deprecation warning; re-run with -deprecation for details
sqlContext: org.apache.spark.sql.SQLContext = org.apache.spark.sql.SQLContext@1dfcf85a
dp10df: org.apache.spark.sql.DataFrame = [Date: timestamp, Open: double ... 5 more fields]
+-----------+--------------------+--------------------+----------+-----------+
|count(Date)|           min(Date)|           max(Date)|min(Close)| max(Close)|
+-----------+--------------------+--------------------+----------+-----------+
|      16793|1950-01-03 00:00:...|2016-09-27 00:00:...|     16.66|2190.149902|
+-----------+--------------------+--------------------+----------+-----------+

sqls: String = SELECT Date,Close,LEAD(Close,1)OVER(ORDER BY Date) leadp FROM tab ORDER BY Date
dp11df: org.apache.spark.sql.DataFrame = [Date: timestamp, Close: double ... 1 more field]
sqls: String = SELECT Date,Close,100*(leadp-Close)/Close pctlead FROM tab ORDER BY Date
dp12df: org.apache.spark.sql.DataFrame = [Date: timestamp, Close: double ... 1 more field]
sqls: String = SELECT Date, Close, pctlead
sqls: String = SELECT Date, Close, pctlead,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS mavg2
sqls: String = SELECT Date, Close, pctlead,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS mavg2,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 3 PRECEDING AND CURRENT ROW) AS mavg3
sqls: String = SELECT Date, Close, pctlead,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS mavg2,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 3 PRECEDING AND CURRENT ROW) AS mavg3,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) AS mavg4
sqls: String = SELECT Date, Close, pctlead,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS mavg2,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 3 PRECEDING AND CURRENT ROW) AS mavg3,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) AS mavg4,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS mavg5
sqls: String = SELECT Date, Close, pctlead,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS mavg2,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 3 PRECEDING AND CURRENT ROW) AS mavg3,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) AS mavg4,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS mavg5,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS mavg6
sqls: String = SELECT Date, Close, pctlead,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS mavg2,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 3 PRECEDING AND CURRENT ROW) AS mavg3,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) AS mavg4,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS mavg5,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS mavg6,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 7 PRECEDING AND CURRENT ROW) AS mavg7
sqls: String = SELECT Date, Close, pctlead,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS mavg2,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 3 PRECEDING AND CURRENT ROW) AS mavg3,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) AS mavg4,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS mavg5,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS mavg6,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 7 PRECEDING AND CURRENT ROW) AS mavg7,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 8 PRECEDING AND CURRENT ROW) AS mavg8
sqls: String = SELECT Date, Close, pctlead,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS mavg2,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 3 PRECEDING AND CURRENT ROW) AS mavg3,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) AS mavg4,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS mavg5,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS mavg6,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 7 PRECEDING AND CURRENT ROW) AS mavg7,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 8 PRECEDING AND CURRENT ROW) AS mavg8,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 9 PRECEDING AND CURRENT ROW) AS mavg9
sqls: String = SELECT Date, Close, pctlead,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS mavg2,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 3 PRECEDING AND CURRENT ROW) AS mavg3,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) AS mavg4,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS mavg5,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS mavg6,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 7 PRECEDING AND CURRENT ROW) AS mavg7,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 8 PRECEDING AND CURRENT ROW) AS mavg8,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 9 PRECEDING AND CURRENT ROW) AS mavg9 FROM tab ORDER BY Date
dp13df: org.apache.spark.sql.DataFrame = [Date: timestamp, Close: double ... 9 more fields]
sqls: String = "SELECT Date, Close, pctlead, pctlead label             "
sqls: String = SELECT Date, Close, pctlead, pctlead label             ,(mavg2-LAG(mavg2,1)OVER(ORDER BY Date))/mavg2 AS slp2
sqls: String = SELECT Date, Close, pctlead, pctlead label             ,(mavg2-LAG(mavg2,1)OVER(ORDER BY Date))/mavg2 AS slp2 ,(mavg3-LAG(mavg3,1)OVER(ORDER BY Date))/mavg3 AS slp3
sqls: String = SELECT Date, Close, pctlead, pctlead label             ,(mavg2-LAG(mavg2,1)OVER(ORDER BY Date))/mavg2 AS slp2 ,(mavg3-LAG(mavg3,1)OVER(ORDER BY Date))/mavg3 AS slp3 ,(mavg3-LAG(mavg4,1)OVER(ORDER BY Date))/mavg3 AS slp4
sqls: String = SELECT Date, Close, pctlead, pctlead label             ,(mavg2-LAG(mavg2,1)OVER(ORDER BY Date))/mavg2 AS slp2 ,(mavg3-LAG(mavg3,1)OVER(ORDER BY Date))/mavg3 AS slp3 ,(mavg3-LAG(mavg4,1)OVER(ORDER BY Date))/mavg3 AS slp4 ,(mavg3-LAG(mavg5,1)OVER(ORDER BY Date))/mavg3 AS slp5
sqls: String = SELECT Date, Close, pctlead, pctlead label             ,(mavg2-LAG(mavg2,1)OVER(ORDER BY Date))/mavg2 AS slp2 ,(mavg3-LAG(mavg3,1)OVER(ORDER BY Date))/mavg3 AS slp3 ,(mavg3-LAG(mavg4,1)OVER(ORDER BY Date))/mavg3 AS slp4 ,(mavg3-LAG(mavg5,1)OVER(ORDER BY Date))/mavg3 AS slp5 ,(mavg3-LAG(mavg6,1)OVER(ORDER BY Date))/mavg3 AS slp6
sqls: String = SELECT Date, Close, pctlead, pctlead label             ,(mavg2-LAG(mavg2,1)OVER(ORDER BY Date))/mavg2 AS slp2 ,(mavg3-LAG(mavg3,1)OVER(ORDER BY Date))/mavg3 AS slp3 ,(mavg3-LAG(mavg4,1)OVER(ORDER BY Date))/mavg3 AS slp4 ,(mavg3-LAG(mavg5,1)OVER(ORDER BY Date))/mavg3 AS slp5 ,(mavg3-LAG(mavg6,1)OVER(ORDER BY Date))/mavg3 AS slp6 ,(mavg3-LAG(mavg7,1)OVER(ORDER BY Date))/mavg3 AS slp7
sqls: String = SELECT Date, Close, pctlead, pctlead label             ,(mavg2-LAG(mavg2,1)OVER(ORDER BY Date))/mavg2 AS slp2 ,(mavg3-LAG(mavg3,1)OVER(ORDER BY Date))/mavg3 AS slp3 ,(mavg3-LAG(mavg4,1)OVER(ORDER BY Date))/mavg3 AS slp4 ,(mavg3-LAG(mavg5,1)OVER(ORDER BY Date))/mavg3 AS slp5 ,(mavg3-LAG(mavg6,1)OVER(ORDER BY Date))/mavg3 AS slp6 ,(mavg3-LAG(mavg7,1)OVER(ORDER BY Date))/mavg3 AS slp7 ,(mavg3-LAG(mavg8,1)OVER(ORDER BY Date))/mavg3 AS slp8
sqls: String = SELECT Date, Close, pctlead, pctlead label             ,(mavg2-LAG(mavg2,1)OVER(ORDER BY Date))/mavg2 AS slp2 ,(mavg3-LAG(mavg3,1)OVER(ORDER BY Date))/mavg3 AS slp3 ,(mavg3-LAG(mavg4,1)OVER(ORDER BY Date))/mavg3 AS slp4 ,(mavg3-LAG(mavg5,1)OVER(ORDER BY Date))/mavg3 AS slp5 ,(mavg3-LAG(mavg6,1)OVER(ORDER BY Date))/mavg3 AS slp6 ,(mavg3-LAG(mavg7,1)OVER(ORDER BY Date))/mavg3 AS slp7 ,(mavg3-LAG(mavg8,1)OVER(ORDER BY Date))/mavg3 AS slp8 ,(mavg3-LAG(mavg9,1)OVER(ORDER BY Date))/mavg3 AS slp9
sqls: String = SELECT Date, Close, pctlead, pctlead label             ,(mavg2-LAG(mavg2,1)OVER(ORDER BY Date))/mavg2 AS slp2 ,(mavg3-LAG(mavg3,1)OVER(ORDER BY Date))/mavg3 AS slp3 ,(mavg3-LAG(mavg4,1)OVER(ORDER BY Date))/mavg3 AS slp4 ,(mavg3-LAG(mavg5,1)OVER(ORDER BY Date))/mavg3 AS slp5 ,(mavg3-LAG(mavg6,1)OVER(ORDER BY Date))/mavg3 AS slp6 ,(mavg3-LAG(mavg7,1)OVER(ORDER BY Date))/mavg3 AS slp7 ,(mavg3-LAG(mavg8,1)OVER(ORDER BY Date))/mavg3 AS slp8 ,(mavg3-LAG(mavg9,1)OVER(ORDER BY Date))/mavg3 AS slp9  FROM tab ORDER BY Date
dp15df: org.apache.spark.sql.DataFrame = [Date: timestamp, Close: double ... 10 more fields]
fill_vec: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(&lt;function8>,org.apache.spark.ml.linalg.VectorUDT@3bfc3ba7,Some(List(FloatType, FloatType, FloatType, FloatType, FloatType, FloatType, FloatType, FloatType)))
dp16df: org.apache.spark.sql.DataFrame = [Date: timestamp, Close: double ... 11 more fields]
lr: org.apache.spark.ml.regression.LinearRegression = linReg_123953898c54
res9: lr.type = linReg_123953898c54
train_df: org.apache.spark.sql.DataFrame = [Date: timestamp, Close: double ... 11 more fields]
model1: org.apache.spark.ml.regression.LinearRegressionModel = linReg_123953898c54
test_df: org.apache.spark.sql.DataFrame = [Date: timestamp, Close: double ... 11 more fields]
predictions_df: org.apache.spark.sql.DataFrame = [Date: timestamp, Close: double ... 12 more fields]
+-----------------+
|           eff_lo|
+-----------------+
|7.806984867599855|
+-----------------+

+-----------------+
|           eff_np|
+-----------------+
|5.383370064167892|
+-----------------+

+------------------+
|            eff_pp|
+------------------+
|13.190354931767743|
+------------------+

+---+
|tpc|
+---+
| 75|
+---+

+---+
|tnc|
+---+
| 27|
+---+

+---+
|fpc|
+---+
| 60|
+---+

+---+
|fnc|
+---+
| 23|
+---+

eff: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(&lt;function2>,FloatType,Some(List(FloatType, DoubleType)))
p2df: org.apache.spark.sql.DataFrame = [Date: timestamp, Close: double ... 13 more fields]
+--------------------+-----------+--------------------+-------------+--------------------+--------------------+
|                Date|      Close|             pctlead|effectiveness|               label|          prediction|
+--------------------+-----------+--------------------+-------------+--------------------+--------------------+
|2016-01-04 00:00:...|2012.660034|  0.2012226074739071|   0.20122261|  0.2012226074739071| 0.11263808558869054|
|2016-01-05 00:00:...|2016.709961|   -1.31153966170151|   -1.3115396|   -1.31153966170151|  0.1338090276443242|
|2016-01-06 00:00:...| 1990.26001| -2.3700443039098174|   -2.3700442| -2.3700443039098174| 0.17766103204264705|
|2016-01-07 00:00:...|1943.089966|  -1.083837463447639|   -1.0838375|  -1.083837463447639| 0.21339307225863266|
|2016-01-08 00:00:...|1922.030029| 0.08532723085774163|   0.08532723| 0.08532723085774163|  0.2661778217053902|
|2016-01-11 00:00:...|1923.670044|  0.7802798638371875|    0.7802799|  0.7802798638371875| 0.24654218958929647|
|2016-01-12 00:00:...|1938.680054| -2.4965452602732516|   -2.4965453| -2.4965452602732516|  0.1749335132058341|
|2016-01-13 00:00:...|1890.280029|   1.669590564139637|    1.6695906|   1.669590564139637| 0.17939470876545158|
|2016-01-14 00:00:...|1921.839966|  -2.159909812178397|   -2.1599097|  -2.159909812178397| 0.10684973684411944|
|2016-01-15 00:00:...|1880.329956|0.053182155440808176|  0.053182155|0.053182155440808176|  0.1971692470121157|
|2016-01-19 00:00:...|1881.329956| -1.1693855152753438|   -1.1693856| -1.1693855152753438| 0.14018492923369166|
|2016-01-20 00:00:...|1859.329956|  0.5195438264643328|    0.5195438|  0.5195438264643328| 0.17832265491265625|
|2016-01-21 00:00:...| 1868.98999|  2.0283700930896904|    2.0283701|  2.0283700930896904| 0.09950224862807228|
|2016-01-22 00:00:...|1906.900024| -1.5637981868314241|   -1.5637982| -1.5637981868314241| 0.05949478758971924|
|2016-01-25 00:00:...|1877.079956|   1.414433568220359|    1.4144336|   1.414433568220359| 0.02549630707443988|
|2016-01-26 00:00:...|1903.630005| -1.0863483946818713|   -1.0863484| -1.0863483946818713|0.008095298383365514|
|2016-01-27 00:00:...|1882.949951|  0.5528577110863419|    0.5528577|  0.5528577110863419| 0.04821389318899666|
|2016-01-28 00:00:...|1893.359985|  2.4760217481832956|    2.4760218|  2.4760217481832956|0.035063483369895454|
|2016-01-29 00:00:...| 1940.23999|-0.04432364060283344|   0.04432364|-0.04432364060283344|-0.04882784926857243|
|2016-02-01 00:00:...|1939.380005| -1.8743091042644822|    1.8743091| -1.8743091042644822|-0.09263639646324615|
|2016-02-02 00:00:...|1903.030029|  0.4992038935398218|    0.4992039|  0.4992038935398218| 0.01056398587781237|
|2016-02-03 00:00:...|1912.530029|  0.1526732629409628|   0.15267326|  0.1526732629409628| 0.02117732652374442|
|2016-02-04 00:00:...|1915.449951| -1.8481246133065947|   -1.8481246| -1.8481246133065947|  0.0740510630205386|
|2016-02-05 00:00:...|1880.050049| -1.4153935962584503|   -1.4153936| -1.4153935962584503|   0.100679916503953|
|2016-02-08 00:00:...|1853.439941|-0.06636201005447463|  -0.06636201|-0.06636201005447463| 0.13634526589262777|
|2016-02-09 00:00:...|1852.209961|-0.01889505009523...|  -0.01889505|-0.01889505009523...|  0.1676332573297664|
|2016-02-10 00:00:...|1851.859985| -1.2301161634528224|   -1.2301161| -1.2301161634528224| 0.17546328458921703|
|2016-02-11 00:00:...|1829.079956|   1.951804943402921|     1.951805|   1.951804943402921| 0.15980773805008383|
|2016-02-12 00:00:...|1864.780029|   1.651665425466653|    1.6516654|   1.651665425466653|0.060599483410193083|
|2016-02-16 00:00:...|1895.579956|   1.648043908731858|    1.6480439|   1.648043908731858|5.750401764712462E-4|
|2016-02-17 00:00:...|1926.819946| -0.4665713586089291|   0.46657136| -0.4665713586089291|-0.09600332908077036|
|2016-02-18 00:00:...|1917.829956|-0.00260330692217...|  0.002603307|-0.00260330692217...|-0.08873916823355094|
|2016-02-19 00:00:...|1917.780029|  1.4454197343192787|   -1.4454198|  1.4454197343192787|-0.06905117288321652|
|2016-02-22 00:00:...|     1945.5| -1.2454371626831184|    1.2454371| -1.2454371626831184|-0.04941699924451...|
|2016-02-23 00:00:...| 1921.27002|   0.443978665736949|  -0.44397867|   0.443978665736949|-0.02071575604470865|
|2016-02-24 00:00:...|1929.800049|   1.134827518081388|   -1.1348275|   1.134827518081388|-0.02553900797429782|
|2016-02-25 00:00:...|1951.699951|-0.18701143063153722|   0.18701144|-0.18701143063153722|-0.03532436571390971|
|2016-02-26 00:00:...|1948.050049| -0.8120976670040306|   0.81209767| -0.8120976670040306|-0.00889280909435...|
|2016-02-29 00:00:...| 1932.22998|  2.3868792264572924|    2.3868792|  2.3868792264572924| 0.02870716807871525|
|2016-03-01 00:00:...|1978.349976| 0.40943084379727995|  -0.40943083| 0.40943084379727995|-0.04735088699513...|
|2016-03-02 00:00:...|1986.449951|  0.3498740552965472|  -0.34987405|  0.3498740552965472|-0.03400544043706...|
|2016-03-03 00:00:...|1993.400024|  0.3305892405266673|  -0.33058923|  0.3305892405266673|-0.07603144189352898|
|2016-03-04 00:00:...| 1999.98999| 0.08850144294971853| -0.088501446| 0.08850144294971853|-0.06024269590462...|
|2016-03-07 00:00:...| 2001.76001|  -1.124010864818905|    1.1240109|  -1.124010864818905|-0.03587911679030167|
|2016-03-08 00:00:...| 1979.26001|  0.5052393293188397|    0.5052393|  0.5052393293188397| 0.04400482041808991|
|2016-03-09 00:00:...| 1989.26001|0.015580467030054408|  0.015580467|0.015580467030054408|0.015394602619397221|
|2016-03-10 00:00:...|1989.569946|  1.6395500477669567|    1.6395501|  1.6395500477669567|0.041994161897273646|
|2016-03-11 00:00:...|2022.189941|-0.12609725467921024|   0.12609726|-0.12609725467921024| -0.0285568171433458|
|2016-03-14 00:00:...|2019.640015| -0.1836941718546818|   0.18369417| -0.1836941718546818|-0.01822888095925962|
|2016-03-15 00:00:...|2015.930054|  0.5600351548705103|  -0.56003517|  0.5600351548705103|-0.02004522722084...|
|2016-03-16 00:00:...|2027.219971|  0.6595236427847927|   0.65952367|  0.6595236427847927| 0.00902394123385248|
|2016-03-17 00:00:...|2040.589966| 0.44056435392665033|  -0.44056436| 0.44056435392665033|-0.01956215732805...|
|2016-03-18 00:00:...|2049.580078| 0.09855774954502321|  -0.09855775| 0.09855774954502321|-0.02889042172459...|
|2016-03-21 00:00:...|2051.600098|-0.08773878504659462|   0.08773878|-0.08773878504659462|-0.04655950888089765|
|2016-03-22 00:00:...|2049.800049| -0.6386031655324603|   0.63860315| -0.6386031655324603|-0.00760072556218...|
|2016-03-23 00:00:...|2036.709961|-0.03780705229240...|  -0.03780705|-0.03780705229240...| 0.03818708362686652|
|2016-03-24 00:00:...|2035.939941| 0.05452557698998718|  0.054525577| 0.05452557698998718|  0.0520797759497303|
|2016-03-28 00:00:...|2037.050049|  0.8816651809226127|   0.88166517|  0.8816651809226127| 0.05248191322007385|
|2016-03-29 00:00:...| 2055.01001| 0.43503150624556275|    0.4350315| 0.43503150624556275|0.014193437681538544|
|2016-03-30 00:00:...|2063.949951|-0.20397592480187138|   0.20397593|-0.20397592480187138|-0.00329836188284...|
|2016-03-31 00:00:...| 2059.73999|  0.6330915097686665|   -0.6330915|  0.6330915097686665|-8.18485640527132...|
|2016-04-01 00:00:...|2072.780029| -0.3208322111829817|   0.32083222| -0.3208322111829817|-0.00155969667989...|
|2016-04-04 00:00:...|2066.129883|  -1.014449245057461|   -1.0144492|  -1.014449245057461|0.016917811767995464|
|2016-04-05 00:00:...|2045.170044|  1.0507619189438957|    1.0507619|  1.0507619189438957| 0.05533376703583057|
|2016-04-06 00:00:...|2066.659912| -1.1975786560861146|   -1.1975787| -1.1975786560861146|0.027486261302928524|
|2016-04-07 00:00:...|2041.910034|   0.278657820631483|   0.27865782|   0.278657820631483| 0.07421557919127666|
|2016-04-08 00:00:...|2047.599976| -0.2739786123146514|  -0.27397862| -0.2739786123146514| 0.05876079519298265|
|2016-04-11 00:00:...| 2041.98999|  0.9662134044055697|    0.9662134|  0.9662134044055697| 0.07607168733416814|
|2016-04-12 00:00:...|2061.719971|  1.0040137017230288|    1.0040137|  1.0040137017230288| 0.03045364926457887|
|2016-04-13 00:00:...|2082.419922|0.017292717774910475|  0.017292717|0.017292717774910475|0.002459456458266125|
|2016-04-14 00:00:...|2082.780029|-0.09842849323767663|  0.098428495|-0.09842849323767663|-0.03778845440301...|
|2016-04-15 00:00:...| 2080.72998|  0.6541025568343978|  -0.65410256|  0.6541025568343978|-0.00330910289606...|
|2016-04-18 00:00:...|2094.340088|   0.308448519751584|  -0.30844852|   0.308448519751584|-0.01731277119474079|
|2016-04-19 00:00:...|2100.800049| 0.07615446318947447|  -0.07615446| 0.07615446318947447|-0.00609875643612...|
|2016-04-20 00:00:...|2102.399902| -0.5194027068595269|    0.5194027| -0.5194027068595269|-0.02271449572507...|
|2016-04-21 00:00:...| 2091.47998|0.004785988914887...|  0.004785989|0.004785988914887...|0.008376202884577369|
|2016-04-22 00:00:...|2091.580078| -0.1812045849864888|  -0.18120459| -0.1812045849864888| 0.03306233860451486|
|2016-04-25 00:00:...|2087.790039|  0.1872751534858758|   0.18727516|  0.1872751534858758| 0.05944010694008735|
|2016-04-26 00:00:...|2091.699951| 0.16493527182762052|   0.16493528| 0.16493527182762052| 0.04249526074142495|
|2016-04-27 00:00:...|2095.149902| -0.9230768157227635|   -0.9230768| -0.9230768157227635|   0.035481682729782|
|2016-04-28 00:00:...|2075.810059| -0.5063088481738572|  -0.50630885| -0.5063088481738572| 0.06337184882071856|
|2016-04-29 00:00:...|2065.300049|   0.780994655367873|   0.78099465|   0.780994655367873|  0.0955897166718418|
|2016-05-02 00:00:...|2081.429932| -0.8676638460102664|  -0.86766386| -0.8676638460102664| 0.07183148745191587|
|2016-05-03 00:00:...|2063.370117| -0.5936889314753995|   -0.5936889| -0.5936889314753995| 0.08727676152164336|
|2016-05-04 00:00:...|2051.120117|-0.02390079429950192| -0.023900794|-0.02390079429950192| 0.08645421931150554|
|2016-05-05 00:00:...|2050.629883| 0.31746391945074204|    0.3174639| 0.31746391945074204| 0.09598502418103601|
|2016-05-06 00:00:...|2057.139893| 0.07534966412709886|  0.075349666| 0.07534966412709886| 0.08446424792855298|
|2016-05-09 00:00:...|2058.689941|  1.2483643839788858|    1.2483643|  1.2483643839788858| 0.06443815079954873|
|2016-05-10 00:00:...|2084.389893| -0.9561518249023676|   0.95615184| -0.9561518249023676|-0.00976562817190...|
|2016-05-11 00:00:...|2064.459961|-0.01694651417848691| -0.016946515|-0.01694651417848691| 0.03099023928476215|
|2016-05-12 00:00:...|2064.110107| -0.8478288992748931|   -0.8478289| -0.8478288992748931| 0.03222244923791139|
|2016-05-13 00:00:...|2046.609985|  0.9796652584981903|    0.9796653|  0.9796652584981903| 0.08669205715592118|
|2016-05-16 00:00:...|2066.659912| -0.9411297372666149|  -0.94112974| -0.9411297372666149| 0.04006951682495726|
|2016-05-17 00:00:...|2047.209961|0.020517875938566795|  0.020517876|0.020517875938566795|  0.0762845135901278|
|2016-05-18 00:00:...|2047.630005|-0.37067077457677733|  -0.37067077|-0.37067077457677733|  0.0422759674530039|
|2016-05-19 00:00:...|2040.040039|   0.601950391425627|    0.6019504|   0.601950391425627| 0.09402157232232455|
|2016-05-20 00:00:...|2052.320068|-0.20854588262009888|  -0.20854588|-0.20854588262009888|0.051483262549937424|
|2016-05-23 00:00:...|2048.040039|  1.3681382915580749|    1.3681383|  1.3681382915580749|  0.0675886435025792|
|2016-05-24 00:00:...|2076.060059|  0.6974740416216479|  -0.69747406|  0.6974740416216479|-0.02081146071682...|
|2016-05-25 00:00:...|2090.540039|-0.02104437091817...|  0.021044372|-0.02104437091817...|-0.02346050014157109|
|2016-05-26 00:00:...|2090.100098|  0.4286857365622697|  -0.42868572|  0.4286857365622697| -0.0427898271277295|
|2016-05-27 00:00:...|2099.060059|-0.10052632800821898|  0.100526325|-0.10052632800821898|-0.02683239987449402|
|2016-05-31 00:00:...|2096.949951| 0.11350423498972209|  -0.11350424| 0.11350423498972209|-0.01642776312356...|
|2016-06-01 00:00:...|2099.330078|  0.2824678244809108|    0.2824678|  0.2824678244809108|0.004065448916935027|
|2016-06-02 00:00:...| 2105.26001| -0.2911814678890852|   0.29118147| -0.2911814678890852|-0.00671586153505...|
|2016-06-03 00:00:...|2099.129883|  0.4897281051188776|    0.4897281|  0.4897281051188776|0.014205148535971726|
|2016-06-06 00:00:...|2109.409912| 0.12894463918684698|   0.12894464| 0.12894463918684698| 0.01253277369135931|
|2016-06-07 00:00:...|2112.129883|  0.3309566355867838|   0.33095664|  0.3309566355867838|0.015962838012416145|
|2016-06-08 00:00:...|2119.120117|   -0.17177586918259|  -0.17177586|   -0.17177586918259|0.006376663492619124|
|2016-06-09 00:00:...| 2115.47998|   -0.91751811331252|  -0.91751814|   -0.91751811331252|0.017547672458622675|
|2016-06-10 00:00:...|2096.070068| -0.8115191023280278|   -0.8115191| -0.8115191023280278| 0.05334576502910113|
|2016-06-13 00:00:...|2079.060059|-0.17988855029992754|  -0.17988855|-0.17988855029992754| 0.10294482441546168|
|2016-06-14 00:00:...|2075.320068| -0.1840712697237789|  -0.18407127| -0.1840712697237789| 0.11094277097790495|
|2016-06-15 00:00:...|     2071.5| 0.31329905865315155|   0.31329906| 0.31329905865315155| 0.10999727773150123|
|2016-06-16 00:00:...| 2077.98999|-0.32579651646926594|   -0.3257965|-0.32579651646926594| 0.07409473259913973|
|2016-06-17 00:00:...|2071.219971|  0.5808185112367291|   0.58081853|  0.5808185112367291| 0.07478953443531737|
|2016-06-20 00:00:...|    2083.25| 0.27120614424577516|   0.27120614| 0.27120614424577516| 0.05029804594356201|
|2016-06-21 00:00:...|2088.899902|-0.16515635798043402|  -0.16515636|-0.16515635798043402| 0.04014334978104682|
|2016-06-22 00:00:...|2085.449951|  1.3364078570495475|    1.3364079|  1.3364078570495475| 0.02621361795455464|
|2016-06-23 00:00:...|2113.320068|  -3.591979991551379|      3.59198|  -3.591979991551379|-0.01678800069228032|
|2016-06-24 00:00:...|2037.410034|  -1.809650212020111|   -1.8096502|  -1.809650212020111| 0.10641864483634167|
|2016-06-27 00:00:...|2000.540039|  1.7770165208875395|    1.7770165|  1.7770165208875395| 0.19039581485464965|
|2016-06-28 00:00:...|2036.089966|  1.7032672710494525|    1.7032672|  1.7032672710494525| 0.16985632359578282|
|2016-06-29 00:00:...| 2070.77002|  1.3565044272758033|    1.3565044|  1.3565044272758033| 0.05643226770408073|
|2016-06-30 00:00:...|2098.860107| 0.19486024753912218|  -0.19486025| 0.19486024753912218|-0.05382657190727346|
|2016-07-01 00:00:...|2102.949951| -0.6847477275031026|   0.68474776| -0.6847477275031026| -0.0979587029879905|
|2016-07-05 00:00:...|2088.550049|  0.5352962934909359|    0.5352963|  0.5352962934909359|4.276545481063376E-5|
|2016-07-06 00:00:...| 2099.72998|-0.08715777825870533|  -0.08715778|-0.08715777825870533|0.016376565129435947|
|2016-07-07 00:00:...|2097.899902|  1.5253349299217422|     1.525335|  1.5253349299217422|0.007313531251173261|
|2016-07-08 00:00:...|2129.899902| 0.34086155847900335|  -0.34086156| 0.34086155847900335|-0.06537246536039465|
|2016-07-11 00:00:...|2137.159912|  0.7009293462734553|  -0.70092934|  0.7009293462734553| -0.0673433755728198|
|2016-07-12 00:00:...|2152.139893|0.013476772627251273| -0.013476772|0.013476772627251273|  -0.074069458702333|
|2016-07-13 00:00:...|2152.429932|  0.5259203949780415|   -0.5259204|  0.5259203949780415|-0.03046243404675...|
|2016-07-14 00:00:...|    2163.75|-0.09289474292316421|   0.09289474|-0.09289474292316421|-0.04194177023786...|
|2016-07-15 00:00:...| 2161.73999| 0.23822952916738127|  -0.23822953| 0.23822952916738127|-0.00906711840819...|
|2016-07-18 00:00:...|2166.889893|-0.14351739837110478|    0.1435174|-0.14351739837110478|-0.02589008526161888|
|2016-07-19 00:00:...|2163.780029|  0.4270300527854589|   0.42703006|  0.4270300527854589|0.010262921109791386|
|2016-07-20 00:00:...| 2173.02002| -0.3612529073708161|    0.3612529| -0.3612529073708161|-0.00106146597748...|
|2016-07-21 00:00:...|2165.169922| 0.45539645178943006|   0.45539644| 0.45539645178943006| 0.03298680250951463|
|2016-07-22 00:00:...|2175.030029|-0.30114752038671483|  -0.30114752|-0.30114752038671483|0.012089633881217005|
|2016-07-25 00:00:...| 2168.47998| 0.03227846263076587|  0.032278463| 0.03227846263076587|0.039814084134506524|
|2016-07-26 00:00:...|2169.179932|-0.11985423438815265| -0.119854234|-0.11985423438815265| 0.03145106033667355|
|2016-07-27 00:00:...|2166.580078| 0.16062092674702202|   0.16062093| 0.16062092674702202| 0.05118350130755939|
|2016-07-28 00:00:...|2170.060059| 0.16313092282023237|   0.16313092| 0.16313092282023237|0.035330835417673984|
|2016-07-29 00:00:...|2173.600098| -0.1269787392142437|  -0.12697874| -0.1269787392142437| 0.03995709971676639|
|2016-08-01 00:00:...|2170.840088| -0.6361619668044343|    -0.636162| -0.6361619668044343|0.030850125685611657|
|2016-08-02 00:00:...|2157.030029| 0.31339433893434987|   0.31339434| 0.31339433893434987| 0.06383838535104035|
|2016-08-03 00:00:...|2163.790039|0.021257191858254098|  0.021257192|0.021257191858254098| 0.05513781889551647|
|2016-08-04 00:00:...|    2164.25|  0.8603496361326065|   0.86034966|  0.8603496361326065|0.058919736280114224|
|2016-08-05 00:00:...|2182.870117| -0.0907165288753599| -0.090716526| -0.0907165288753599| 0.01138444617137116|
|2016-08-08 00:00:...|2180.889893|0.038979363549189745|  0.038979363|0.038979363549189745|0.010636794613299281|
|2016-08-09 00:00:...| 2181.73999|-0.28646859977113953|   -0.2864686|-0.28646859977113953|0.007106631876149...|
|2016-08-10 00:00:...| 2175.48999|  0.4734588091577449|    0.4734588|  0.4734588091577449|0.041791673922212315|
|2016-08-11 00:00:...|2185.790039|-0.07960462665462967| -0.079604626|-0.07960462665462967|0.022192824991828362|
|2016-08-12 00:00:...|2184.050049| 0.27929089824626846|   0.27929088| 0.27929089824626846| 0.03187891668884704|
|2016-08-15 00:00:...|2190.149902| -0.5479077020728967|   -0.5479077| -0.5479077020728967|0.005816966463467826|
|2016-08-16 00:00:...|2178.149902| 0.18685899424381655|     0.186859| 0.18685899424381655|0.043343354004975077|
|2016-08-17 00:00:...|2182.219971|  0.2199617391366979|   0.21996173|  0.2199617391366979| 0.03917714724067952|
|2016-08-18 00:00:...| 2187.02002|-0.14402716807320287|  -0.14402717|-0.14402716807320287| 0.04738720502947054|
|2016-08-19 00:00:...|2183.870117| -0.0563322878235028| -0.056332286| -0.0563322878235028| 0.03343387061096782|
|2016-08-22 00:00:...|2182.639893| 0.19517690543742305|    0.1951769| 0.19517690543742305| 0.04142276869927339|
|2016-08-23 00:00:...|2186.899902|   -0.52402768821378|   -0.5240277|   -0.52402768821378|  0.0332723854265316|
|2016-08-24 00:00:...|2175.439941|-0.13652273013958158|  -0.13652273|-0.13652273013958158| 0.06229805400648457|
|2016-08-25 00:00:...|2172.469971|-0.15788167596264593|  -0.15788168|-0.15788167596264593| 0.05999139616645344|
|2016-08-26 00:00:...|2169.040039|  0.5228047337119758|   0.52280474|  0.5228047337119758| 0.06948620479362366|
|2016-08-29 00:00:...|2180.379883| -0.1953680655931885|  -0.19536807| -0.1953680655931885|0.045795222997927265|
|2016-08-30 00:00:...|2176.120117|-0.23758642547395195|  -0.23758642|-0.23758642547395195| 0.04688189465686225|
|2016-08-31 00:00:...|2170.949951|-0.00413846482083...| -0.004138465|-0.00413846482083...| 0.04300609318174804|
|2016-09-01 00:00:...|2170.860107|  0.4201041315648488|   0.42010415|  0.4201041315648488| 0.05802618867175227|
|2016-09-02 00:00:...| 2179.97998|  0.2981678758352634|   0.29816788|  0.2981678758352634|  0.0399315007453231|
|2016-09-06 00:00:...| 2186.47998|-0.01463850585999...| -0.014638506|-0.01463850585999...|0.025196240550609858|
|2016-09-07 00:00:...|2186.159912| -0.2223013501127694|  -0.22230135| -0.2223013501127694|0.009695601490200038|
|2016-09-08 00:00:...|2181.300049| -2.4522068857295496|   -2.4522069| -2.4522068857295496| 0.02942055266295585|
|2016-09-09 00:00:...|2127.810059|   1.467705252539182|    1.4677052|   1.467705252539182|    0.12758615610104|
|2016-09-12 00:00:...|2159.040039| -1.4830674013266898|   -1.4830674| -1.4830674013266898| 0.09266696590182819|
|2016-09-13 00:00:...| 2127.02002|-0.05876766500768526| -0.058767665|-0.05876766500768526| 0.14159066062075848|
|2016-09-14 00:00:...| 2125.77002|  1.0109273250546658|    1.0109273|  1.0109273250546658| 0.09717088538178381|
|2016-09-15 00:00:...| 2147.26001| -0.3772294907126729|  -0.37722948| -0.3772294907126729|  0.0760856372201624|
|2016-09-16 00:00:...|2139.159912|-0.00186030973079...|-0.0018603097|-0.00186030973079...|  0.0544552942204296|
|2016-09-19 00:00:...|2139.120117|0.029913841439509457|   0.02991384|0.029913841439509457| 0.07165904769340573|
|2016-09-20 00:00:...| 2139.76001|  1.0917162154086604|    1.0917162|  1.0917162154086604| 0.03445167577247412|
|2016-09-21 00:00:...|2163.120117|  0.6499784681166678|   0.64997846|  0.6499784681166678|0.018852009926014143|
|2016-09-22 00:00:...|2177.179932| -0.5736774814255415|    0.5736775| -0.5736774814255415|-0.02372417749249...|
|2016-09-23 00:00:...|2164.689941| -0.8587762454059558|    0.8587763| -0.8587762454059558|-0.01850626067441...|
|2016-09-26 00:00:...|2146.100098|  0.6444170061260637|     0.644417|  0.6444170061260637| 0.03819224352907297|
|2016-09-27 00:00:...|2159.929932|                null|         null|                null| 0.04418289952428672|
+--------------------+-----------+--------------------+-------------+--------------------+--------------------+


Welcome to
      ____              __
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 2.0.0
      /_/
         
Using Scala version 2.11.8 (Java HotSpot(TM) 64-Bit Server VM, Java 1.8.0_102)
Type in expressions to have them evaluated.
Type :help for more information.

scala> (75.0+27.0) / 185.0
res25: Double = 0.5513513513513514
scala> 
scala>
</code>
