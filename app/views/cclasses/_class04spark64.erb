<code class='bash'>
dan@pavlap:/tmp $ 
dan@pavlap:/tmp $ 
dan@pavlap:/tmp $ spark-shell -i logr12.scala
Spark context Web UI available at http://192.168.1.80:4040
Spark context available as 'sc' (master = local[*], app id = local-1475044132416).
Spark session available as 'spark'.
Loading logr12.scala...
import org.apache.spark.sql.SQLContext
import org.apache.spark.ml.classification.LogisticRegression
import org.apache.spark.ml.linalg.{Vector, Vectors}
import org.apache.spark.ml.param.ParamMap
import org.apache.spark.sql.Row
import org.apache.spark.sql.functions._
import sys.process._
warning: there was one feature warning; re-run with -feature for details
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
100 1181k    0 1181k    0     0  1479k      0 --:--:-- --:--:-- --:--:-- 1479k
res2: Int = 0
warning: there was one deprecation warning; re-run with -deprecation for details
sqlContext: org.apache.spark.sql.SQLContext = org.apache.spark.sql.SQLContext@3c4059a
dp10df: org.apache.spark.sql.DataFrame = [Date: timestamp, Open: double ... 5 more fields]
+-----------+--------------------+--------------------+----------+-----------+
|count(Date)|           min(Date)|           max(Date)|min(Close)| max(Close)|
+-----------+--------------------+--------------------+----------+-----------+
|      16793|1950-01-03 00:00:...|2016-09-27 00:00:...|     16.66|2190.149902|
+-----------+--------------------+--------------------+----------+-----------+

sqls: String = SELECT Date,Close,LEAD(Close,1)OVER(ORDER BY Date) leadp FROM tab ORDER BY Date
dp11df: org.apache.spark.sql.DataFrame = [Date: timestamp, Close: double ... 1 more field]
sqls: String = SELECT Date,Close,100*(leadp-Close)/Close pctlead FROM tab ORDER BY Date
dp12df: org.apache.spark.sql.DataFrame = [Date: timestamp, Close: double ... 1 more field]
sqls: String = SELECT Date, Close, pctlead
sqls: String = SELECT Date, Close, pctlead,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS mavg2
sqls: String = SELECT Date, Close, pctlead,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS mavg2,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 3 PRECEDING AND CURRENT ROW) AS mavg3
sqls: String = SELECT Date, Close, pctlead,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS mavg2,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 3 PRECEDING AND CURRENT ROW) AS mavg3,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) AS mavg4
sqls: String = SELECT Date, Close, pctlead,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS mavg2,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 3 PRECEDING AND CURRENT ROW) AS mavg3,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) AS mavg4,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS mavg5
sqls: String = SELECT Date, Close, pctlead,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS mavg2,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 3 PRECEDING AND CURRENT ROW) AS mavg3,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) AS mavg4,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS mavg5,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS mavg6
sqls: String = SELECT Date, Close, pctlead,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS mavg2,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 3 PRECEDING AND CURRENT ROW) AS mavg3,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) AS mavg4,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS mavg5,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS mavg6,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 7 PRECEDING AND CURRENT ROW) AS mavg7
sqls: String = SELECT Date, Close, pctlead,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS mavg2,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 3 PRECEDING AND CURRENT ROW) AS mavg3,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) AS mavg4,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS mavg5,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS mavg6,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 7 PRECEDING AND CURRENT ROW) AS mavg7,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 8 PRECEDING AND CURRENT ROW) AS mavg8
sqls: String = SELECT Date, Close, pctlead,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS mavg2,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 3 PRECEDING AND CURRENT ROW) AS mavg3,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) AS mavg4,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS mavg5,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS mavg6,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 7 PRECEDING AND CURRENT ROW) AS mavg7,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 8 PRECEDING AND CURRENT ROW) AS mavg8,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 9 PRECEDING AND CURRENT ROW) AS mavg9
sqls: String = SELECT Date, Close, pctlead,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS mavg2,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 3 PRECEDING AND CURRENT ROW) AS mavg3,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 4 PRECEDING AND CURRENT ROW) AS mavg4,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 5 PRECEDING AND CURRENT ROW) AS mavg5,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 6 PRECEDING AND CURRENT ROW) AS mavg6,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 7 PRECEDING AND CURRENT ROW) AS mavg7,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 8 PRECEDING AND CURRENT ROW) AS mavg8,AVG(Close)OVER(ORDER BY Date ROWS BETWEEN 9 PRECEDING AND CURRENT ROW) AS mavg9 FROM tab ORDER BY Date
dp13df: org.apache.spark.sql.DataFrame = [Date: timestamp, Close: double ... 9 more fields]
sqls: String = SELECT Date, Close, pctlead
sqls: String = SELECT Date, Close, pctlead,(mavg2-LAG(mavg2,1)OVER(ORDER BY Date))/mavg2 AS slp2
sqls: String = SELECT Date, Close, pctlead,(mavg2-LAG(mavg2,1)OVER(ORDER BY Date))/mavg2 AS slp2 ,(mavg3-LAG(mavg3,1)OVER(ORDER BY Date))/mavg3 AS slp3
sqls: String = SELECT Date, Close, pctlead,(mavg2-LAG(mavg2,1)OVER(ORDER BY Date))/mavg2 AS slp2 ,(mavg3-LAG(mavg3,1)OVER(ORDER BY Date))/mavg3 AS slp3 ,(mavg3-LAG(mavg4,1)OVER(ORDER BY Date))/mavg3 AS slp4
sqls: String = SELECT Date, Close, pctlead,(mavg2-LAG(mavg2,1)OVER(ORDER BY Date))/mavg2 AS slp2 ,(mavg3-LAG(mavg3,1)OVER(ORDER BY Date))/mavg3 AS slp3 ,(mavg3-LAG(mavg4,1)OVER(ORDER BY Date))/mavg3 AS slp4 ,(mavg3-LAG(mavg5,1)OVER(ORDER BY Date))/mavg3 AS slp5
sqls: String = SELECT Date, Close, pctlead,(mavg2-LAG(mavg2,1)OVER(ORDER BY Date))/mavg2 AS slp2 ,(mavg3-LAG(mavg3,1)OVER(ORDER BY Date))/mavg3 AS slp3 ,(mavg3-LAG(mavg4,1)OVER(ORDER BY Date))/mavg3 AS slp4 ,(mavg3-LAG(mavg5,1)OVER(ORDER BY Date))/mavg3 AS slp5 ,(mavg3-LAG(mavg6,1)OVER(ORDER BY Date))/mavg3 AS slp6
sqls: String = SELECT Date, Close, pctlead,(mavg2-LAG(mavg2,1)OVER(ORDER BY Date))/mavg2 AS slp2 ,(mavg3-LAG(mavg3,1)OVER(ORDER BY Date))/mavg3 AS slp3 ,(mavg3-LAG(mavg4,1)OVER(ORDER BY Date))/mavg3 AS slp4 ,(mavg3-LAG(mavg5,1)OVER(ORDER BY Date))/mavg3 AS slp5 ,(mavg3-LAG(mavg6,1)OVER(ORDER BY Date))/mavg3 AS slp6 ,(mavg3-LAG(mavg7,1)OVER(ORDER BY Date))/mavg3 AS slp7
sqls: String = SELECT Date, Close, pctlead,(mavg2-LAG(mavg2,1)OVER(ORDER BY Date))/mavg2 AS slp2 ,(mavg3-LAG(mavg3,1)OVER(ORDER BY Date))/mavg3 AS slp3 ,(mavg3-LAG(mavg4,1)OVER(ORDER BY Date))/mavg3 AS slp4 ,(mavg3-LAG(mavg5,1)OVER(ORDER BY Date))/mavg3 AS slp5 ,(mavg3-LAG(mavg6,1)OVER(ORDER BY Date))/mavg3 AS slp6 ,(mavg3-LAG(mavg7,1)OVER(ORDER BY Date))/mavg3 AS slp7 ,(mavg3-LAG(mavg8,1)OVER(ORDER BY Date))/mavg3 AS slp8
sqls: String = SELECT Date, Close, pctlead,(mavg2-LAG(mavg2,1)OVER(ORDER BY Date))/mavg2 AS slp2 ,(mavg3-LAG(mavg3,1)OVER(ORDER BY Date))/mavg3 AS slp3 ,(mavg3-LAG(mavg4,1)OVER(ORDER BY Date))/mavg3 AS slp4 ,(mavg3-LAG(mavg5,1)OVER(ORDER BY Date))/mavg3 AS slp5 ,(mavg3-LAG(mavg6,1)OVER(ORDER BY Date))/mavg3 AS slp6 ,(mavg3-LAG(mavg7,1)OVER(ORDER BY Date))/mavg3 AS slp7 ,(mavg3-LAG(mavg8,1)OVER(ORDER BY Date))/mavg3 AS slp8 ,(mavg3-LAG(mavg9,1)OVER(ORDER BY Date))/mavg3 AS slp9
sqls: String = SELECT Date, Close, pctlead,(mavg2-LAG(mavg2,1)OVER(ORDER BY Date))/mavg2 AS slp2 ,(mavg3-LAG(mavg3,1)OVER(ORDER BY Date))/mavg3 AS slp3 ,(mavg3-LAG(mavg4,1)OVER(ORDER BY Date))/mavg3 AS slp4 ,(mavg3-LAG(mavg5,1)OVER(ORDER BY Date))/mavg3 AS slp5 ,(mavg3-LAG(mavg6,1)OVER(ORDER BY Date))/mavg3 AS slp6 ,(mavg3-LAG(mavg7,1)OVER(ORDER BY Date))/mavg3 AS slp7 ,(mavg3-LAG(mavg8,1)OVER(ORDER BY Date))/mavg3 AS slp8 ,(mavg3-LAG(mavg9,1)OVER(ORDER BY Date))/mavg3 AS slp9  FROM tab ORDER BY Date
dp14df: org.apache.spark.sql.DataFrame = [Date: timestamp, Close: double ... 9 more fields]
training_period: String = " WHERE Date BETWEEN'1986-01-01'AND'2016-01-01' "
sqls: String = "SELECT AVG(pctlead) FROM tab WHERE Date BETWEEN'1986-01-01'AND'2016-01-01' "
class_df: org.apache.spark.sql.DataFrame = [avg(pctlead): double]
class_boundry: Double = 0.03667703897236846
pctlead2label: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(&lt;function1>,DoubleType,Some(List(FloatType)))
dp15df: org.apache.spark.sql.DataFrame = [Date: timestamp, Close: double ... 10 more fields]
fill_vec: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(&lt;function8>,org.apache.spark.ml.linalg.VectorUDT@3bfc3ba7,Some(List(FloatType, FloatType, FloatType, FloatType, FloatType, FloatType, FloatType, FloatType)))
dp16df: org.apache.spark.sql.DataFrame = [Date: timestamp, Close: double ... 11 more fields]
lr: org.apache.spark.ml.classification.LogisticRegression = logreg_0b3a7441c96e
res9: lr.type = logreg_0b3a7441c96e
train_df: org.apache.spark.sql.DataFrame = [Date: timestamp, Close: double ... 11 more fields]
model1: org.apache.spark.ml.classification.LogisticRegressionModel = logreg_0b3a7441c96e
test_period: String = " WHERE Date BETWEEN'2016-01-01'AND'2017-01-01' "
test_df: org.apache.spark.sql.DataFrame = [Date: timestamp, Close: double ... 11 more fields]
predictions_df: org.apache.spark.sql.DataFrame = [Date: timestamp, Close: double ... 14 more fields]
+-----------------+
|           eff_lo|
+-----------------+
|7.806984867599855|
+-----------------+

+------------------+
|            eff_np|
+------------------+
|2.1769234387218557|
+------------------+

+-----------------+
|           eff_pp|
+-----------------+
|9.983908306321712|
+-----------------+

+---+
|tpc|
+---+
| 75|
+---+

+---+
|tnc|
+---+
| 19|
+---+

+---+
|fpc|
+---+
| 68|
+---+

+---+
|fnc|
+---+
| 23|
+---+

eff: org.apache.spark.sql.expressions.UserDefinedFunction = UserDefinedFunction(&lt;function2>,FloatType,Some(List(FloatType, DoubleType)))
p2df: org.apache.spark.sql.DataFrame = [Date: timestamp, Close: double ... 15 more fields]
+--------------------+-----------+--------------------+-------------+-----+----------+
|                Date|      Close|             pctlead|effectiveness|label|prediction|
+--------------------+-----------+--------------------+-------------+-----+----------+
|2016-01-04 00:00:...|2012.660034|  0.2012226074739071|   0.20122261|  1.0|       1.0|
|2016-01-05 00:00:...|2016.709961|   -1.31153966170151|   -1.3115396|  0.0|       1.0|
|2016-01-06 00:00:...| 1990.26001| -2.3700443039098174|   -2.3700442|  0.0|       1.0|
|2016-01-07 00:00:...|1943.089966|  -1.083837463447639|   -1.0838375|  0.0|       1.0|
|2016-01-08 00:00:...|1922.030029| 0.08532723085774163|   0.08532723|  1.0|       1.0|
|2016-01-11 00:00:...|1923.670044|  0.7802798638371875|    0.7802799|  1.0|       1.0|
|2016-01-12 00:00:...|1938.680054| -2.4965452602732516|   -2.4965453|  0.0|       1.0|
|2016-01-13 00:00:...|1890.280029|   1.669590564139637|    1.6695906|  1.0|       1.0|
|2016-01-14 00:00:...|1921.839966|  -2.159909812178397|   -2.1599097|  0.0|       1.0|
|2016-01-15 00:00:...|1880.329956|0.053182155440808176|  0.053182155|  1.0|       1.0|
|2016-01-19 00:00:...|1881.329956| -1.1693855152753438|   -1.1693856|  0.0|       1.0|
|2016-01-20 00:00:...|1859.329956|  0.5195438264643328|    0.5195438|  1.0|       1.0|
|2016-01-21 00:00:...| 1868.98999|  2.0283700930896904|    2.0283701|  1.0|       1.0|
|2016-01-22 00:00:...|1906.900024| -1.5637981868314241|   -1.5637982|  0.0|       1.0|
|2016-01-25 00:00:...|1877.079956|   1.414433568220359|    1.4144336|  1.0|       1.0|
|2016-01-26 00:00:...|1903.630005| -1.0863483946818713|   -1.0863484|  0.0|       1.0|
|2016-01-27 00:00:...|1882.949951|  0.5528577110863419|    0.5528577|  1.0|       1.0|
|2016-01-28 00:00:...|1893.359985|  2.4760217481832956|    2.4760218|  1.0|       1.0|
|2016-01-29 00:00:...| 1940.23999|-0.04432364060283344|   0.04432364|  0.0|       0.0|
|2016-02-01 00:00:...|1939.380005| -1.8743091042644822|    1.8743091|  0.0|       0.0|
|2016-02-02 00:00:...|1903.030029|  0.4992038935398218|   -0.4992039|  1.0|       0.0|
|2016-02-03 00:00:...|1912.530029|  0.1526732629409628|   0.15267326|  1.0|       1.0|
|2016-02-04 00:00:...|1915.449951| -1.8481246133065947|   -1.8481246|  0.0|       1.0|
|2016-02-05 00:00:...|1880.050049| -1.4153935962584503|   -1.4153936|  0.0|       1.0|
|2016-02-08 00:00:...|1853.439941|-0.06636201005447463|  -0.06636201|  0.0|       1.0|
|2016-02-09 00:00:...|1852.209961|-0.01889505009523...|  -0.01889505|  0.0|       1.0|
|2016-02-10 00:00:...|1851.859985| -1.2301161634528224|   -1.2301161|  0.0|       1.0|
|2016-02-11 00:00:...|1829.079956|   1.951804943402921|     1.951805|  1.0|       1.0|
|2016-02-12 00:00:...|1864.780029|   1.651665425466653|    1.6516654|  1.0|       1.0|
|2016-02-16 00:00:...|1895.579956|   1.648043908731858|    1.6480439|  1.0|       1.0|
|2016-02-17 00:00:...|1926.819946| -0.4665713586089291|   0.46657136|  0.0|       0.0|
|2016-02-18 00:00:...|1917.829956|-0.00260330692217...| -0.002603307|  0.0|       1.0|
|2016-02-19 00:00:...|1917.780029|  1.4454197343192787|    1.4454198|  1.0|       1.0|
|2016-02-22 00:00:...|     1945.5| -1.2454371626831184|    1.2454371|  0.0|       0.0|
|2016-02-23 00:00:...| 1921.27002|   0.443978665736949|  -0.44397867|  1.0|       0.0|
|2016-02-24 00:00:...|1929.800049|   1.134827518081388|   -1.1348275|  1.0|       0.0|
|2016-02-25 00:00:...|1951.699951|-0.18701143063153722|   0.18701144|  0.0|       0.0|
|2016-02-26 00:00:...|1948.050049| -0.8120976670040306|   0.81209767|  0.0|       0.0|
|2016-02-29 00:00:...| 1932.22998|  2.3868792264572924|    2.3868792|  1.0|       1.0|
|2016-03-01 00:00:...|1978.349976| 0.40943084379727995|  -0.40943083|  1.0|       0.0|
|2016-03-02 00:00:...|1986.449951|  0.3498740552965472|  -0.34987405|  1.0|       0.0|
|2016-03-03 00:00:...|1993.400024|  0.3305892405266673|  -0.33058923|  1.0|       0.0|
|2016-03-04 00:00:...| 1999.98999| 0.08850144294971853| -0.088501446|  1.0|       0.0|
|2016-03-07 00:00:...| 2001.76001|  -1.124010864818905|    1.1240109|  0.0|       0.0|
|2016-03-08 00:00:...| 1979.26001|  0.5052393293188397|    0.5052393|  1.0|       1.0|
|2016-03-09 00:00:...| 1989.26001|0.015580467030054408| -0.015580467|  0.0|       0.0|
|2016-03-10 00:00:...|1989.569946|  1.6395500477669567|    1.6395501|  1.0|       1.0|
|2016-03-11 00:00:...|2022.189941|-0.12609725467921024|   0.12609726|  0.0|       0.0|
|2016-03-14 00:00:...|2019.640015| -0.1836941718546818|   0.18369417|  0.0|       0.0|
|2016-03-15 00:00:...|2015.930054|  0.5600351548705103|   0.56003517|  1.0|       1.0|
|2016-03-16 00:00:...|2027.219971|  0.6595236427847927|   0.65952367|  1.0|       1.0|
|2016-03-17 00:00:...|2040.589966| 0.44056435392665033|   0.44056436|  1.0|       1.0|
|2016-03-18 00:00:...|2049.580078| 0.09855774954502321|  -0.09855775|  1.0|       0.0|
|2016-03-21 00:00:...|2051.600098|-0.08773878504659462|   0.08773878|  0.0|       0.0|
|2016-03-22 00:00:...|2049.800049| -0.6386031655324603|   0.63860315|  0.0|       0.0|
|2016-03-23 00:00:...|2036.709961|-0.03780705229240...|  -0.03780705|  0.0|       1.0|
|2016-03-24 00:00:...|2035.939941| 0.05452557698998718|  0.054525577|  1.0|       1.0|
|2016-03-28 00:00:...|2037.050049|  0.8816651809226127|   0.88166517|  1.0|       1.0|
|2016-03-29 00:00:...| 2055.01001| 0.43503150624556275|   -0.4350315|  1.0|       0.0|
|2016-03-30 00:00:...|2063.949951|-0.20397592480187138|   0.20397593|  0.0|       0.0|
|2016-03-31 00:00:...| 2059.73999|  0.6330915097686665|    0.6330915|  1.0|       1.0|
|2016-04-01 00:00:...|2072.780029| -0.3208322111829817|  -0.32083222|  0.0|       1.0|
|2016-04-04 00:00:...|2066.129883|  -1.014449245057461|   -1.0144492|  0.0|       1.0|
|2016-04-05 00:00:...|2045.170044|  1.0507619189438957|    1.0507619|  1.0|       1.0|
|2016-04-06 00:00:...|2066.659912| -1.1975786560861146|   -1.1975787|  0.0|       1.0|
|2016-04-07 00:00:...|2041.910034|   0.278657820631483|   0.27865782|  1.0|       1.0|
|2016-04-08 00:00:...|2047.599976| -0.2739786123146514|  -0.27397862|  0.0|       1.0|
|2016-04-11 00:00:...| 2041.98999|  0.9662134044055697|    0.9662134|  1.0|       1.0|
|2016-04-12 00:00:...|2061.719971|  1.0040137017230288|    1.0040137|  1.0|       1.0|
|2016-04-13 00:00:...|2082.419922|0.017292717774910475|  0.017292717|  0.0|       1.0|
|2016-04-14 00:00:...|2082.780029|-0.09842849323767663| -0.098428495|  0.0|       1.0|
|2016-04-15 00:00:...| 2080.72998|  0.6541025568343978|   0.65410256|  1.0|       1.0|
|2016-04-18 00:00:...|2094.340088|   0.308448519751584|   0.30844852|  1.0|       1.0|
|2016-04-19 00:00:...|2100.800049| 0.07615446318947447|  -0.07615446|  1.0|       0.0|
|2016-04-20 00:00:...|2102.399902| -0.5194027068595269|    0.5194027|  0.0|       0.0|
|2016-04-21 00:00:...| 2091.47998|0.004785988914887...| -0.004785989|  0.0|       0.0|
|2016-04-22 00:00:...|2091.580078| -0.1812045849864888|  -0.18120459|  0.0|       1.0|
|2016-04-25 00:00:...|2087.790039|  0.1872751534858758|   0.18727516|  1.0|       1.0|
|2016-04-26 00:00:...|2091.699951| 0.16493527182762052|   0.16493528|  1.0|       1.0|
|2016-04-27 00:00:...|2095.149902| -0.9230768157227635|   -0.9230768|  0.0|       1.0|
|2016-04-28 00:00:...|2075.810059| -0.5063088481738572|  -0.50630885|  0.0|       1.0|
|2016-04-29 00:00:...|2065.300049|   0.780994655367873|   0.78099465|  1.0|       1.0|
|2016-05-02 00:00:...|2081.429932| -0.8676638460102664|  -0.86766386|  0.0|       1.0|
|2016-05-03 00:00:...|2063.370117| -0.5936889314753995|   -0.5936889|  0.0|       1.0|
|2016-05-04 00:00:...|2051.120117|-0.02390079429950192| -0.023900794|  0.0|       1.0|
|2016-05-05 00:00:...|2050.629883| 0.31746391945074204|    0.3174639|  1.0|       1.0|
|2016-05-06 00:00:...|2057.139893| 0.07534966412709886|  0.075349666|  1.0|       1.0|
|2016-05-09 00:00:...|2058.689941|  1.2483643839788858|    1.2483643|  1.0|       1.0|
|2016-05-10 00:00:...|2084.389893| -0.9561518249023676|  -0.95615184|  0.0|       1.0|
|2016-05-11 00:00:...|2064.459961|-0.01694651417848691| -0.016946515|  0.0|       1.0|
|2016-05-12 00:00:...|2064.110107| -0.8478288992748931|   -0.8478289|  0.0|       1.0|
|2016-05-13 00:00:...|2046.609985|  0.9796652584981903|    0.9796653|  1.0|       1.0|
|2016-05-16 00:00:...|2066.659912| -0.9411297372666149|  -0.94112974|  0.0|       1.0|
|2016-05-17 00:00:...|2047.209961|0.020517875938566795|  0.020517876|  0.0|       1.0|
|2016-05-18 00:00:...|2047.630005|-0.37067077457677733|  -0.37067077|  0.0|       1.0|
|2016-05-19 00:00:...|2040.040039|   0.601950391425627|    0.6019504|  1.0|       1.0|
|2016-05-20 00:00:...|2052.320068|-0.20854588262009888|  -0.20854588|  0.0|       1.0|
|2016-05-23 00:00:...|2048.040039|  1.3681382915580749|    1.3681383|  1.0|       1.0|
|2016-05-24 00:00:...|2076.060059|  0.6974740416216479|   0.69747406|  1.0|       1.0|
|2016-05-25 00:00:...|2090.540039|-0.02104437091817...| -0.021044372|  0.0|       1.0|
|2016-05-26 00:00:...|2090.100098|  0.4286857365622697|  -0.42868572|  1.0|       0.0|
|2016-05-27 00:00:...|2099.060059|-0.10052632800821898| -0.100526325|  0.0|       1.0|
|2016-05-31 00:00:...|2096.949951| 0.11350423498972209|   0.11350424|  1.0|       1.0|
|2016-06-01 00:00:...|2099.330078|  0.2824678244809108|   -0.2824678|  1.0|       0.0|
|2016-06-02 00:00:...| 2105.26001| -0.2911814678890852|   0.29118147|  0.0|       0.0|
|2016-06-03 00:00:...|2099.129883|  0.4897281051188776|   -0.4897281|  1.0|       0.0|
|2016-06-06 00:00:...|2109.409912| 0.12894463918684698|  -0.12894464|  1.0|       0.0|
|2016-06-07 00:00:...|2112.129883|  0.3309566355867838|   0.33095664|  1.0|       1.0|
|2016-06-08 00:00:...|2119.120117|   -0.17177586918259|  -0.17177586|  0.0|       1.0|
|2016-06-09 00:00:...| 2115.47998|   -0.91751811331252|  -0.91751814|  0.0|       1.0|
|2016-06-10 00:00:...|2096.070068| -0.8115191023280278|   -0.8115191|  0.0|       1.0|
|2016-06-13 00:00:...|2079.060059|-0.17988855029992754|  -0.17988855|  0.0|       1.0|
|2016-06-14 00:00:...|2075.320068| -0.1840712697237789|  -0.18407127|  0.0|       1.0|
|2016-06-15 00:00:...|     2071.5| 0.31329905865315155|   0.31329906|  1.0|       1.0|
|2016-06-16 00:00:...| 2077.98999|-0.32579651646926594|   -0.3257965|  0.0|       1.0|
|2016-06-17 00:00:...|2071.219971|  0.5808185112367291|   0.58081853|  1.0|       1.0|
|2016-06-20 00:00:...|    2083.25| 0.27120614424577516|   0.27120614|  1.0|       1.0|
|2016-06-21 00:00:...|2088.899902|-0.16515635798043402|  -0.16515636|  0.0|       1.0|
|2016-06-22 00:00:...|2085.449951|  1.3364078570495475|    1.3364079|  1.0|       1.0|
|2016-06-23 00:00:...|2113.320068|  -3.591979991551379|     -3.59198|  0.0|       1.0|
|2016-06-24 00:00:...|2037.410034|  -1.809650212020111|   -1.8096502|  0.0|       1.0|
|2016-06-27 00:00:...|2000.540039|  1.7770165208875395|    1.7770165|  1.0|       1.0|
|2016-06-28 00:00:...|2036.089966|  1.7032672710494525|    1.7032672|  1.0|       1.0|
|2016-06-29 00:00:...| 2070.77002|  1.3565044272758033|    1.3565044|  1.0|       1.0|
|2016-06-30 00:00:...|2098.860107| 0.19486024753912218|  -0.19486025|  1.0|       0.0|
|2016-07-01 00:00:...|2102.949951| -0.6847477275031026|  -0.68474776|  0.0|       1.0|
|2016-07-05 00:00:...|2088.550049|  0.5352962934909359|    0.5352963|  1.0|       1.0|
|2016-07-06 00:00:...| 2099.72998|-0.08715777825870533|  -0.08715778|  0.0|       1.0|
|2016-07-07 00:00:...|2097.899902|  1.5253349299217422|     1.525335|  1.0|       1.0|
|2016-07-08 00:00:...|2129.899902| 0.34086155847900335|  -0.34086156|  1.0|       0.0|
|2016-07-11 00:00:...|2137.159912|  0.7009293462734553|  -0.70092934|  1.0|       0.0|
|2016-07-12 00:00:...|2152.139893|0.013476772627251273| -0.013476772|  0.0|       0.0|
|2016-07-13 00:00:...|2152.429932|  0.5259203949780415|   -0.5259204|  1.0|       0.0|
|2016-07-14 00:00:...|    2163.75|-0.09289474292316421|   0.09289474|  0.0|       0.0|
|2016-07-15 00:00:...| 2161.73999| 0.23822952916738127|  -0.23822953|  1.0|       0.0|
|2016-07-18 00:00:...|2166.889893|-0.14351739837110478|    0.1435174|  0.0|       0.0|
|2016-07-19 00:00:...|2163.780029|  0.4270300527854589|  -0.42703006|  1.0|       0.0|
|2016-07-20 00:00:...| 2173.02002| -0.3612529073708161|    0.3612529|  0.0|       0.0|
|2016-07-21 00:00:...|2165.169922| 0.45539645178943006|   0.45539644|  1.0|       1.0|
|2016-07-22 00:00:...|2175.030029|-0.30114752038671483|  -0.30114752|  0.0|       1.0|
|2016-07-25 00:00:...| 2168.47998| 0.03227846263076587|  0.032278463|  0.0|       1.0|
|2016-07-26 00:00:...|2169.179932|-0.11985423438815265| -0.119854234|  0.0|       1.0|
|2016-07-27 00:00:...|2166.580078| 0.16062092674702202|   0.16062093|  1.0|       1.0|
|2016-07-28 00:00:...|2170.060059| 0.16313092282023237|   0.16313092|  1.0|       1.0|
|2016-07-29 00:00:...|2173.600098| -0.1269787392142437|  -0.12697874|  0.0|       1.0|
|2016-08-01 00:00:...|2170.840088| -0.6361619668044343|    -0.636162|  0.0|       1.0|
|2016-08-02 00:00:...|2157.030029| 0.31339433893434987|   0.31339434|  1.0|       1.0|
|2016-08-03 00:00:...|2163.790039|0.021257191858254098|  0.021257192|  0.0|       1.0|
|2016-08-04 00:00:...|    2164.25|  0.8603496361326065|   0.86034966|  1.0|       1.0|
|2016-08-05 00:00:...|2182.870117| -0.0907165288753599| -0.090716526|  0.0|       1.0|
|2016-08-08 00:00:...|2180.889893|0.038979363549189745|  0.038979363|  1.0|       1.0|
|2016-08-09 00:00:...| 2181.73999|-0.28646859977113953|   -0.2864686|  0.0|       1.0|
|2016-08-10 00:00:...| 2175.48999|  0.4734588091577449|    0.4734588|  1.0|       1.0|
|2016-08-11 00:00:...|2185.790039|-0.07960462665462967| -0.079604626|  0.0|       1.0|
|2016-08-12 00:00:...|2184.050049| 0.27929089824626846|   0.27929088|  1.0|       1.0|
|2016-08-15 00:00:...|2190.149902| -0.5479077020728967|   -0.5479077|  0.0|       1.0|
|2016-08-16 00:00:...|2178.149902| 0.18685899424381655|     0.186859|  1.0|       1.0|
|2016-08-17 00:00:...|2182.219971|  0.2199617391366979|   0.21996173|  1.0|       1.0|
|2016-08-18 00:00:...| 2187.02002|-0.14402716807320287|  -0.14402717|  0.0|       1.0|
|2016-08-19 00:00:...|2183.870117| -0.0563322878235028| -0.056332286|  0.0|       1.0|
|2016-08-22 00:00:...|2182.639893| 0.19517690543742305|    0.1951769|  1.0|       1.0|
|2016-08-23 00:00:...|2186.899902|   -0.52402768821378|   -0.5240277|  0.0|       1.0|
|2016-08-24 00:00:...|2175.439941|-0.13652273013958158|  -0.13652273|  0.0|       1.0|
|2016-08-25 00:00:...|2172.469971|-0.15788167596264593|  -0.15788168|  0.0|       1.0|
|2016-08-26 00:00:...|2169.040039|  0.5228047337119758|   0.52280474|  1.0|       1.0|
|2016-08-29 00:00:...|2180.379883| -0.1953680655931885|  -0.19536807|  0.0|       1.0|
|2016-08-30 00:00:...|2176.120117|-0.23758642547395195|  -0.23758642|  0.0|       1.0|
|2016-08-31 00:00:...|2170.949951|-0.00413846482083...| -0.004138465|  0.0|       1.0|
|2016-09-01 00:00:...|2170.860107|  0.4201041315648488|   0.42010415|  1.0|       1.0|
|2016-09-02 00:00:...| 2179.97998|  0.2981678758352634|   0.29816788|  1.0|       1.0|
|2016-09-06 00:00:...| 2186.47998|-0.01463850585999...| -0.014638506|  0.0|       1.0|
|2016-09-07 00:00:...|2186.159912| -0.2223013501127694|  -0.22230135|  0.0|       1.0|
|2016-09-08 00:00:...|2181.300049| -2.4522068857295496|   -2.4522069|  0.0|       1.0|
|2016-09-09 00:00:...|2127.810059|   1.467705252539182|    1.4677052|  1.0|       1.0|
|2016-09-12 00:00:...|2159.040039| -1.4830674013266898|   -1.4830674|  0.0|       1.0|
|2016-09-13 00:00:...| 2127.02002|-0.05876766500768526| -0.058767665|  0.0|       1.0|
|2016-09-14 00:00:...| 2125.77002|  1.0109273250546658|    1.0109273|  1.0|       1.0|
|2016-09-15 00:00:...| 2147.26001| -0.3772294907126729|  -0.37722948|  0.0|       1.0|
|2016-09-16 00:00:...|2139.159912|-0.00186030973079...|-0.0018603097|  0.0|       1.0|
|2016-09-19 00:00:...|2139.120117|0.029913841439509457|   0.02991384|  0.0|       1.0|
|2016-09-20 00:00:...| 2139.76001|  1.0917162154086604|    1.0917162|  1.0|       1.0|
|2016-09-21 00:00:...|2163.120117|  0.6499784681166678|   0.64997846|  1.0|       1.0|
|2016-09-22 00:00:...|2177.179932| -0.5736774814255415|    0.5736775|  0.0|       0.0|
|2016-09-23 00:00:...|2164.689941| -0.8587762454059558|    0.8587763|  0.0|       0.0|
|2016-09-26 00:00:...|2146.100098|  0.6444170061260637|     0.644417|  1.0|       1.0|
|2016-09-27 00:00:...|2159.929932|                null|         null| null|       1.0|
+--------------------+-----------+--------------------+-------------+-----+----------+


Welcome to
      ____              __
     / __/__  ___ _____/ /__
    _\ \/ _ \/ _ `/ __/  '_/
   /___/ .__/\_,_/_/ /_/\_\   version 2.0.0
      /_/
         
Using Scala version 2.11.8 (Java HotSpot(TM) 64-Bit Server VM, Java 1.8.0_102)
Type in expressions to have them evaluated.
Type :help for more information.

scala> 
scala> 
scala> 
</code>
